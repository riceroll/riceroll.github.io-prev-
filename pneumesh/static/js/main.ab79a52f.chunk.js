(this.webpackJsonpreact3=this.webpackJsonpreact3||[]).push([[0],{53:function(e,t,n){},73:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var i=n(0),a=n.n(i),o=n(26),s=n.n(o),r=(n(73),n(10)),c=n(7),l=n(13),h=n(4),d=n(1),u=function e(t,n,i,a,o){Object(h.a)(this,e),this.pos=t,this.fixed=n,this.pos0=i,this.vel=a,this.force=o,this.vs=[],this.es=[],this.fs=[],this.id=e.all.length,e.all.push(this)};u.all=[];var v=function e(t,n,i,a,o,s){Object(h.a)(this,e),this.vs=[],this.lMax=n,this.maxContraction=i,this.edgeChannel=a,this.edgeActive=o,this.l=s;var r,c=Object(l.a)(t);try{for(c.s();!(r=c.n()).done;){var d=r.value;this.vs.push(u.all[d])}}catch(v){c.e(v)}finally{c.f()}u.all[t[0]].vs.push(u.all[t[1]]),u.all[t[1]].vs.push(u.all[t[0]]),u.all[t[0]].es.push(this),u.all[t[1]].es.push(this),this.id=e.all.length,e.all.push(this)};v.all=[];var f=function(){function e(){Object(h.a)(this,e),this.viewer=null,this.Vertex=u,this.Edge=v,this.Model=e,this.controls=null,this.sharedData=null,e.configure(),this.reset(),this.loadData(),this.resetSelection(),this.recordV()}return Object(c.a)(e,[{key:"reset",value:function(){this.v=[],this.e=[],this.v0=[],this.c=[],this.a0=[],this.fixedVs=[],this.lMax=[],this.edgeActive=[],this.edgeChannel=[],this.script=[],this.maxContraction=[],this.vel=[],this.f=[],this.l=[],this.vStatus=[],this.eStatus=[],this.fStatus=[],this.iAction=0,this.iActionPrev=0,this.numSteps=0,this.timeStart=new Date,this.editing=!1,this.simulate=!0,e.gravity=!0,this.directional=!1,this.euler=new d.Euler(0,0,0),this.numChannels=e.defaultNumChannels,this.numActions=e.defaultNumActions,this.inflateChannel=new Array(this.numChannels).fill(!1),this.contractionPercent=new Array(this.numChannels).fill(1)}},{key:"loadDict",value:function(e){console.log(e);for(var t,n,i,a,o,s,r=[],c=Array.from(e.e),l=[],h=[],u=0;u<e.v.length;u++)r.push(new d.Vector3(e.v[u][0],e.v[u][1],e.v[u][2]));this.reset(),e.lMax&&(t=e.lMax),e.maxContraction&&(n=e.maxContraction),e.fixedVs&&(i=e.fixedVs),e.edgeChannel&&(a=e.edgeChannel),e.edgeActive&&(o=e.edgeActive),e.script&&(s=e.script),e.numChannels&&(this.numChannels=e.numChannels),e.numActions&&(this.numActions=e.numActions),this.loadData(r,c,l,h,t,n,i,a,o,s),e.lMax||e.maxContraction||e.fixedVs||this.loadData(r,c,l,h)}},{key:"loadData",value:function(e,t,n,i){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];e&&t?(this.v=e,this.e=t):(this.v.push(new d.Vector3(1,-1/Math.sqrt(3),.2)),this.v.push(new d.Vector3(0,2/Math.sqrt(3),.2)),this.v.push(new d.Vector3(-1,-1/Math.sqrt(3),.2)),this.v.push(new d.Vector3(0,0,4/Math.sqrt(6)+.2)),this.e.push([0,1]),this.e.push([1,2]),this.e.push([2,0]),this.e.push([0,3]),this.e.push([1,3]),this.e.push([2,3])),s&&(this.fixedVs=s),a&&(this.lMax=a),o&&(this.maxContraction=o),c&&(this.edgeActive=c),r&&(this.edgeChannel=r),l&&(this.script=l),this.updateCorners(),this.precompute(),this.initCheck(),this.resetSelection(),this.recordV()}},{key:"saveData",value:function(){var e,t={v:[]},n=Object(l.a)(this.v);try{for(n.s();!(e=n.n()).done;){var i=e.value;t.v.push([i.x,i.y,i.z])}}catch(d){n.e(d)}finally{n.f()}t.v0=[];var a,o=Object(l.a)(this.v0);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.v0.push([s.x,s.y,s.z])}}catch(d){o.e(d)}finally{o.f()}t.e=[];for(var r=0;r<this.e.length;r++)t.e.push(this.e[r].slice());t.fixedVs=this.fixedVs.slice(),t.lMax=this.lMax.slice(),t.edgeChannel=this.edgeChannel.slice(),t.edgeActive=this.edgeActive.slice(),t.script=[];for(var c=0;c<this.script.length;c++){var h=this.script[c].slice();t.script.push(h)}return t.maxContraction=this.maxContraction.slice(),t.vStatus=this.vStatus.slice(),t.eStatus=this.eStatus.slice(),t.fStatus=this.fStatus.slice(),t.euler=this.euler.clone(),t.numChannels=this.numChannels,t.numActions=this.numActions,t.inflateChannel=this.inflateChannel.slice(),t.contractionPercent=this.contractionPercent.slice(),t}},{key:"sameData",value:function(e,t){var n=!0;return JSON.stringify(e.e)!==JSON.stringify(t.e)&&(n=!1),JSON.stringify(e.fixedVs)!==JSON.stringify(t.fixedVs)&&(n=!1),JSON.stringify(e.lMax)!==JSON.stringify(t.lMax)&&(n=!1),JSON.stringify(e.edgeChannel)!==JSON.stringify(t.edgeChannel)&&(n=!1),JSON.stringify(e.edgeActive)!==JSON.stringify(t.edgeActive)&&(n=!1),JSON.stringify(e.script)!==JSON.stringify(t.script)&&(n=!1),JSON.stringify(e.maxContraction)!==JSON.stringify(t.maxContraction)&&(n=!1),e.euler.x!==t.euler.x&&(n=!1),e.euler.y!==t.euler.y&&(n=!1),e.euler.z!==t.euler.z&&(n=!1),e.numChannels!==t.numChannels&&(n=!1),e.numActions!==t.numActions&&(n=!1),n}},{key:"recordHistory",value:function(){var t=this.saveData();-1!==this.Model.iHistory&&this.sameData(t,this.Model.history[this.Model.iHistory])||(console.log("record"),e.history=e.history.slice(0,e.iHistory+1),e.history.push(this.saveData()),e.history.length>50&&e.history.shift(),e.iHistory=e.history.length-1)}},{key:"applyHistory",value:function(t){if(-1!==t){var n=e.history[t],i=this.simulate,a=this.Model.gravity;this.loadDict(n),this.simulate=i,this.Model.gravity=a,this.forceUpdate()}}},{key:"undo",value:function(){e.iHistory-1>=0&&(e.iHistory-=1),this.applyHistory(e.iHistory)}},{key:"redo",value:function(){e.iHistory+1<e.history.length&&(console.log(e.iHistory),e.iHistory+=1,console.log("yes"),console.log(e.iHistory)),this.applyHistory(e.iHistory)}},{key:"resetSelection",value:function(){this.vStatus=new Array(this.v.length).fill(0),this.eStatus=new Array(this.e.length).fill(0),this.fStatus=new Array(this.f.length).fill(0)}},{key:"recordV",value:function(){this.v0=[];var e,t=-this.bbox()[5],n=Object(l.a)(this.v);try{for(n.s();!(e=n.n()).done;){var i=e.value.clone();i.z+=t,this.v0.push(i)}}catch(a){n.e(a)}finally{n.f()}}},{key:"resetV",value:function(){this.iAction=0,this.numSteps=0;for(var e=0;e<this.v.length;e++)this.v[e].copy(this.v0[e]);this.numSteps=0}},{key:"precompute",value:function(){var t=this,n=function(e,t){for(var n=0;n<Math.min(e.length,t.length);n++)t[n]=e[n];return t};this.l=[];for(var i=0;i<this.e.length;i++){var a=this.e[i];this.l.push(this.v[a[0]].distanceTo(this.v[a[1]]))}if(this.vel.length!==this.v.length){this.vel=[];for(var o=0;o<this.v.length;o++)this.vel.push(new d.Vector3)}if(this.maxContraction.length!==this.e.length){var s=new Array(this.e.length).fill(e.maxMaxContraction);this.maxContraction=n(this.maxContraction,s)}if(this.fixedVs.length!==this.v.length){var r=new Array(this.v.length).fill(!1);this.fixedVs=n(this.fixedVs,r)}if(this.lMax.length!==this.e.length){var c=new Array(this.e.length).fill(e.defaultMaxLength);this.lMax=n(this.lMax,c)}if(this.edgeActive.length!==this.e.length){var l=new Array(this.e.length).fill(!0);this.edgeActive=n(this.edgeActive,l)}if(this.edgeChannel.length!==this.e.length){var h=new Array(this.e.length).fill(0);this.edgeChannel=n(this.edgeChannel,h)}if(this.script.length!==this.numChannels||this.script.length&&this.script[0].length!==this.numActions){var u=Array(this.numChannels).fill(!1).map((function(e){return Array(t.numActions).fill(!1)}));0===this.script.length&&(this.script=u);for(var v=0;v<Math.min(this.script.length,u.length);v++)for(var f=0;f<Math.min(this.script[0].length,u[0].length);f++)u[v][f]=this.script[v][f];this.script=u}}},{key:"initCheck",value:function(){for(var e=0;e<this.e.length;e++)this.edgeActive[e]&&this.lMax[e]!==this.Model.defaultMaxLength&&(console.log("An active beam is having wrong max length ".concat(this.lMax[e],".")),this.lMax[e]=this.Model.defaultMaxLength)}},{key:"updateCorners",value:function(){this.updateDataStructure(),this.c=[],this.a0=[];var t,n=Object(l.a)(u.all);try{for(n.s();!(t=n.n()).done;)for(var i=t.value.es,a=0;a<i.length-1;a++){var o=i[a],s=i[a+1],c=e.getAngle(o,s,!0),h=Object(r.a)(c,2),d=h[0],v=h[1];this.c.push(v),this.a0.push(d)}}catch(f){n.e(f)}finally{n.f()}}},{key:"checkCorners",value:function(){for(var t=0;t<this.c.length;t++){var n=Object(r.a)(this.c[t],3),i=n[0],a=n[1],o=n[2],s=this.v[a].clone().sub(this.v[i]),c=this.v[o].clone().sub(this.v[i]),l=s.angleTo(c);if(Math.abs(l-this.a0[t])>e.angleThreshold)return!1}return!0}},{key:"update",value:function(){this.f=[];for(var t=0;t<this.v.length;t++)this.f.push(new d.Vector3);for(var n=0;n<this.e.length;n++){var i=this.e[n],a=this.v[i[0]],o=this.v[i[1]].clone().sub(a),s=this.lMax[n];if(this.edgeActive[n]){var r=this.edgeChannel[n],c=s,l=c*(1-this.maxContraction[n]);s=c-this.contractionPercent[r]*(c-l)}var h=(o.length()-s)*e.k;h=o.normalize().multiplyScalar(h),this.f[i[0]].add(h),this.f[i[1]].add(h.negate())}for(var u=0;u<this.v.length;u++)e.gravity&&this.f[u].add(new d.Vector3(0,0,-e.gravityFactor*e.gravity))}},{key:"runScript",value:function(){if(0===this.script.length)return 0;if(this.numSteps>(this.iAction+1)%this.numActions*e.numStepsAction){this.iAction=Math.floor(this.numSteps/e.numStepsAction)%this.numActions,this.editing&&(this.iAction=0);for(var t=0;t<this.numChannels;t++)this.inflateChannel[t]=this.script[t][this.iAction]}}},{key:"step",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=0;i<t;i++){if(this.precompute(),!this.simulate)return;n&&this.runScript(),this.editing;for(var a=0;a<this.inflateChannel.length;a++)this.inflateChannel[a]?(this.contractionPercent[a]-=e.contractionPercentRate,this.contractionPercent[a]<0&&(this.contractionPercent[a]=0)):(this.contractionPercent[a]+=e.contractionPercentRate,this.contractionPercent[a]>1&&(this.contractionPercent[a]=1));this.update();for(var o=0;o<this.v.length;o++)this.fixedVs[o]||this.sharedData.movingJoint&&!this.sharedData.movingBody&&2!==this.vStatus[o]||(this.vel[o].add(this.f[o].clone().multiplyScalar(e.h)),this.v[o].z<=0&&(this.vel[o].x*=1-e.frictionFactor,this.vel[o].y*=1-e.frictionFactor),this.vel[o].multiplyScalar(e.dampingRatio),this.vel[o].length()>5&&this.vel[o].multiplyScalar(Math.pow(.9,Math.ceil(Math.log(5/this.vel[o].length())/Math.log(.9)))),this.v[o].add(this.vel[o].clone().multiplyScalar(e.h)),this.v[o].z<=0&&(this.vel[o].z=-this.vel[o].z,this.v[o].z=0));this.numSteps,e.angleCheckFrequency,this.numSteps+=1}return this.v}},{key:"addJoint",value:function(t){var n=new d.Vector3;n.copy(this.v[t]);var i=new d.Vector3(e.defaultMinLength,0,0);n=n.add(i),this.v.push(n);var a=[t,this.v.length-1];this.e.push(a)}},{key:"addEdges",value:function(e){for(var t=0;t<e.length;t++)for(var n=t+1;n<e.length;n++){var i,a=!0,o=Object(l.a)(this.e);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(s.includes(e[t])&&s.includes(e[n])){a=!1;break}}}catch(r){o.e(r)}finally{o.f()}a&&this.e.push([e[t],e[n]])}this.updateCorners()}},{key:"addTet",value:function(e){if(3===e.length){var t,n=e[0],i=e[1],a=e[2],o=this.v[n],s=this.v[i],r=this.v[a],c=0,h=[],u=Object(l.a)(this.e);try{for(u.s();!(t=u.n()).done;){var v=t.value,f=0,p=!1;v.includes(n)&&(p||(h.push(v),p=!0),f+=1),v.includes(i)&&(p||(h.push(v),p=!0),f+=1),v.includes(a)&&(p||(h.push(v),p=!0),f+=1),console.assert(f<=2),2===f&&(c+=1)}}catch(D){u.e(D)}finally{u.f()}if(console.assert(c<=3),3===c){var g,j={},m=Object(l.a)(h);try{for(m.s();!(g=m.n()).done;){var y=g.value;y[0]in j?j[y[0]]+=1:j[y[0]]=1,y[1]in j?j[y[1]]+=1:j[y[1]]=1}}catch(D){m.e(D)}finally{m.f()}var b=0,x=-1;for(var O in j)if(O=parseInt(O),![n,i,a].includes(O)){var C=j[O];3===C&&(x=O,b+=1),console.log("iv_mirror: ",x),console.assert(C<=3)}if(b>1)return void console.log("more than one tet connected.");if(-1!==x){var S=this.v[x],w=new d.Vector3;w.copy(S);var M=new d.Vector3,A=new d.Vector3;M.subVectors(s,o),A.subVectors(r,s);var k=M.cross(A).normalize();S.clone().sub(o).dot(k)<0&&k.negate();var P=S.clone().sub(o).dot(k),U=k.multiplyScalar(-2*P);w.add(U),this.v.push(w);var V=[n,this.v.length-1],J=[i,this.v.length-1],I=[a,this.v.length-1];this.e.push(V),this.e.push(J),this.e.push(I)}}else console.log("Points not in a triangle.")}}},{key:"removeJoint",value:function(t){if(![0,1,2,3].includes(t)){this.updateDataStructure();var n,i=[],a=u.all[t],o=Object(l.a)(a.es);try{for(o.s();!(n=o.n()).done;){var s=n.value;i.push(s)}}catch(r){o.e(r)}finally{o.f()}u.all=u.all.filter((function(e){return e!==a})),v.all=v.all.filter((function(e){return!i.includes(e)})),e.reindexObjects(u),e.reindexObjects(v),this.updateFromDataStructure(),this.updateCorners(),this.forceUpdate()}}},{key:"removeEdge",value:function(e){}},{key:"updateDataStructure",value:function(){u.all=[];for(var e=0;e<this.v.length;e++)new u(this.v[e],this.fixedVs[e],this.v0[e],this.vel[e],this.f[e]);v.all=[];for(var t=0;t<this.e.length;t++)new v(this.e[t],this.lMax[t],this.maxContraction[t],this.edgeChannel[t],this.edgeActive[t],this.l[t])}},{key:"updateFromDataStructure",value:function(){this.v=[],this.fixedVs=[],this.v0=[],this.vel=[],this.f=[];var e,t=Object(l.a)(u.all);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.v.push(n.pos),this.fixedVs.push(n.fixed),this.v0.push(n.pos0),this.vel.push(n.vel),this.f.push(n.f)}}catch(r){t.e(r)}finally{t.f()}this.e=[],this.lMax=[],this.maxContraction=[],this.edgeChannel=[],this.edgeActive=[],this.l=[];var i,a=Object(l.a)(v.all);try{for(a.s();!(i=a.n()).done;){var o=i.value,s=[o.vs[0].id,o.vs[1].id];this.e.push(s),this.lMax.push(o.lMax),this.maxContraction.push(o.maxContraction),this.edgeChannel.push(o.edgeChannel),this.edgeActive.push(o.edgeActive),this.l.push(o.l)}}catch(r){a.e(r)}finally{a.f()}this.vStatus=new Array(this.v.length).fill(0),this.eStatus=new Array(this.e.length).fill(0)}},{key:"centroid",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=new d.Vector3(0,0,0),i=t?this.v0:this.v,a=Object(l.a)(i);try{for(a.s();!(e=a.n()).done;){var o=e.value;n.add(o)}}catch(s){a.e(s)}finally{a.f()}return n.divideScalar(this.v.length),n}},{key:"center",value:function(){for(var e=this.centroid(),t=this.bbox(),n=Object(r.a)(t,6),i=n[0],a=n[1],o=n[2],s=n[3],c=n[4],l=n[5],h=(Math.max([o-l,a-c,i-s]),0);h<this.v.length;h++)this.v[h].x-=e.x,this.v[h].y-=e.y,this.v[h].z-=l,this.v[h].z+=o-l;this.recordV()}},{key:"align",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t.length>0){var n,i=new d.Vector3(0,0,0),a=Object(l.a)(t);try{for(a.s();!(n=a.n()).done;){var o=n.value,s=this.v[o];i.add(s)}}catch(u){a.e(u)}finally{a.f()}i.divideScalar(t.length);var r=this.centroid();i.sub(r);var c=i.clone();c.z=0;var h=Math.atan2(c.y,c.x);e||(h-=Math.PI/2),this.rotateTo(this.euler.x,this.euler.y,this.euler.z-h)}}},{key:"stepsPerSecond",value:function(){var e=new Date;return this.numSteps/((e.getTime()-this.timeStart.getTime())/1e3)}},{key:"bbox",value:function(){var e,t,n,i,a,o;e=t=n=-1/0,i=a=o=1/0;var s,r=Object(l.a)(this.v);try{for(r.s();!(s=r.n()).done;){var c=s.value;c.x>e&&(e=c.x),c.y>t&&(t=c.y),c.z>n&&(n=c.z),c.x<i&&(i=c.x),c.y<a&&(a=c.y),c.z<o&&(o=c.z)}}catch(h){r.e(h)}finally{r.f()}return[e,t,n,i,a,o]}},{key:"infoJoints",value:function(){return"joints: "+this.v.length}},{key:"infoBeams",value:function(){return"actuators: "+this.e.length}},{key:"fixJoints",value:function(e){for(var t=0;t<e.length;t++){e[t];alert("not implemented")}}},{key:"unfixAll",value:function(){this.fixedVs=[],this.fixedVs=new Array(this.v.length).fill(!1)}},{key:"rotateTo",value:function(e,t,n){var i=this.centroid(),a=new d.Euler;a.setFromVector3(this.euler.toVector3().negate(),"ZYX"),this.euler=new d.Euler(e,t,n);for(var o=0;o<this.v.length;o++)this.v[o].sub(i),this.v[o].applyEuler(a),this.v[o].applyEuler(this.euler),this.v[o].add(i);this.recordV()}}],[{key:"configure",value:function(){!function(t){var n=new XMLHttpRequest;n.open("GET",t,!1),n.onreadystatechange=function(){4===n.readyState&&(200!==n.status&&0!==n.status||function(t){var n=JSON.parse(t);e.k=n.k,e.h=n.h,e.dampingRatio=n.dampingRatio,e.contractionInterval=n.contractionInterval,e.contractionLevels=n.contractionLevels,e.maxMaxContraction=Math.round(e.contractionInterval*(e.contractionLevels-1)*100)/100,e.contractionPercentRate=n.contractionPercentRate,e.gravityFactor=n.gravityFactor,e.gravity=Boolean(n.gravity),e.defaultMinLength=n.defaultMinLength,e.defaultMaxLength=e.defaultMinLength/(1-e.maxMaxContraction),e.frictionFactor=n.frictionFactor,e.numStepsAction=n.numStepsActionMultiplier/e.h,e.defaultNumActions=n.defaultNumActions,e.defaultNumChannels=n.defaultNumChannels,e.angleThreshold=n.angleThreshold,e.angleCheckFrequency=e.numStepsAction*n.angleCheckFrequencyMultiplier}(n.responseText))},n.send(null)}("config.json")}},{key:"getAngle",value:function(e,t){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=e.vs,o=t.vs;a[0]===o[0]?n=[a[0],a[1],o[1]]:a[0]===o[1]?n=[a[0],a[1],o[0]]:a[1]===o[0]?n=[a[1],a[0],o[1]]:a[1]===o[1]?n=[a[1],a[0],o[0]]:console.error("edges not intersected");var s=n[0].pos.clone(),r=n[1].pos.clone(),c=n[2].pos.clone();return r.sub(s),c.sub(s),i?[r.angleTo(c),[n[0].id,n[1].id,n[2].id]]:r.angleTo(c)}}]),e}();f.history=[],f.iHistory=-1,f.reindexObjects=function(e){var t,n=0,i=Object(l.a)(e.all);try{for(i.s();!(t=i.n()).done;){t.value.id=n,n+=1}}catch(a){i.e(a)}finally{i.f()}};n.p,n(53);var p=n(23),g=n(55),j=n(131),m=n(2);Object(p.b)({OrbitControls:g.a});var y=new d.Color(.6,.6,.6),b=[new d.Color(.1,.3,.6),new d.Color(.5,.4,.1),new d.Color(.5,.1,.5),new d.Color(.1,.5,.2),new d.Color(.6,.1,.4)],x=(new d.Color(1,1,1),new d.Color(.05,.05,.05)),O=new d.Color(.9,0,0),C=new d.Color(.9,.05,0),S=new d.Color(.2,.6,.6),w=new d.Color(.15,.15,.15),M=.026,A=!1;function k(e){var t=e.v,n=e.d,a=e.c,o=e.model,s=e.handleClick,c=e.handlePointerOver,l=e.handlePointerOut,h=e.setOControls,u=e.translating,v=Object(i.useRef)(),f=Object(i.useRef)(),g=Object(i.useRef)(),y=Object(i.useState)(!1),b=Object(r.a)(y,2),x=b[0],O=b[1],C=new d.Vector3;return Object(p.c)((function(e){if(null!==v.current&&(v.current.position.copy(t),f.current.color.copy(a),u)){var n=g.current;x?(t.copy(n.worldPosition.clone().add(n.position)),v.current.position.copy(t)):g.current.position.copy(t)}})),Object(i.useEffect)((function(){var e=function(e){h(!e.value),O(e.value);var t=e.target;!1===e.value?(t.object.position.multiplyScalar(0),o.simulate=!0,o.recordHistory()):C.copy(t.worldPosition)},n=g.current;if(n.position.copy(t),n)return n.addEventListener("dragging-changed",e),function(){n.removeEventListener("dragging-changed",e)}})),Object(m.jsx)(j.a,{ref:g,enabled:u,showX:u,showY:u,showZ:u,mode:"translate",space:"local",children:Object(m.jsxs)("mesh",{ref:v,position:t,castShadow:!0,scale:[n,n,n],onClick:s,onPointerOver:c,onPointerOut:l,children:[Object(m.jsx)("sphereBufferGeometry",{args:[1,20,20]}),Object(m.jsx)("meshLambertMaterial",{ref:f,color:a})]})})}function P(e){var t=e.v,n=e.iv,a=e.model,o=e.setOControls,s=e.sharedData,c=(a.vStatus[n],a.vStatus[n],Object(i.useState)(!1)),l=Object(r.a)(c,2),h=l[0],u=l[1],v=new d.Color;Object(p.c)((function(e){var t=2===a.vStatus[n],i=1===a.vStatus[n],o=a.fixedVs[n];v.copy(t?O:i?C:o?S:y),s.movingJoint&&2===a.vStatus[n]&&!h&&u(!0),s.movingJoint&&2===a.vStatus[n]||!h||u(!1)}));return Object(m.jsx)(k,{v:t,d:.06,model:a,handleClick:function(e){s.removingJoint?(a.removeJoint(n),a.precompute(),a.recordV(),a.forceUpdate()):s.addingJoint?(a.addJoint(n),a.precompute(),a.recordV(),a.forceUpdate()):s.movingJoint?(a.vStatus.fill(0),a.vStatus[n]=2):a.vStatus[n]=2,s.updateGUI(),e.stopPropagation()},handlePointerOver:function(e){2!==a.vStatus[n]&&(a.vStatus[n]=1),e.stopPropagation()},handlePointerOut:function(e){2!==a.vStatus[n]&&(a.vStatus[n]=0),e.stopPropagation()},setOControls:o,translating:h,c:v},"ball")}function U(e){var t=e.v0,n=e.v1,a=e.d,o=e.c,s=(e.opacity,e.transparent,e.handleClick),c=e.handlePointerOver,l=e.handlePointerOut,h=Object(i.useRef)(),u=Object(i.useRef)(),v=function(e,t){var n=e.clone().add(t).divideScalar(2),i=t.clone().sub(e),a=new d.Vector3(0,1,0),o=i.length();i.normalize();var s=(new d.Quaternion).setFromUnitVectors(a,i);return[n,o,(new d.Euler).setFromQuaternion(s)]},f=v(t,n),g=Object(r.a)(f,3),j=g[0],y=g[1],b=g[2];return Object(p.c)((function(e){if(null!==h.current){var i=v(t,n),a=Object(r.a)(i,3),s=a[0],c=a[1],l=a[2];h.current.position.copy(s),h.current.rotation.copy(l),h.current.scale[1]=c,u.current.color.copy(o)}})),Object(m.jsxs)("mesh",{ref:h,position:[j.x,j.y,j.z],rotation:b,castShadow:!0,scale:[a,y,a],onClick:s,onPointerOver:c,onPointerOut:l,children:[Object(m.jsx)("cylinderBufferGeometry",{args:[1,1,1,20]}),Object(m.jsx)("meshLambertMaterial",{ref:u,color:o})]})}function V(e){var t=e.v0,n=e.v1,i=e.ie,a=e.model,o=e.sharedData,s=n.clone().sub(t);s.length();s.normalize();var r=s.clone().multiplyScalar(.527),c=s.clone().multiplyScalar(.33),l=s.clone().multiplyScalar(.04),h=c.clone().add(t),u=h.clone().add(r),v=n.clone().sub(c),f=v.clone().sub(r),g=t.clone(),j=t.clone().add(c),S=n.clone(),k=n.clone().sub(c),P=v.clone().sub(s.clone().multiplyScalar(a.lMax[i]*(a.Model.maxMaxContraction-a.maxContraction[i]))),V=P.clone().add(l),J=new d.Color,I=new d.Color,D=new d.Color,L=new d.Color,G=new d.Color,z=function(){var e=b[a.edgeChannel[i]];if(o.showChannel){var t=2===a.eStatus[i],n=1===a.eStatus[i];J.copy(t?O:n?C:e),I.copy(t?O:n?C:e),D.copy(t?O:n?C:e),L.copy(t?O:n?C:e)}else{var s=2===a.eStatus[i],r=1===a.eStatus[i];J.copy(s?O:r?C:x),I.copy(s?O:r?C:y),D.copy(s?O:r?C:y),L.copy(s?O:r?C:w),G.copy(e)}G.copy(e)};z(),Object(p.c)((function(e){var o=n.clone().sub(t);o.length();o.normalize();var s=o.clone().multiplyScalar(.527),r=o.clone().multiplyScalar(.33),c=o.clone().multiplyScalar(.04);h.copy(r.clone().add(t)),u.copy(h.clone().add(s)),v.copy(n.clone().sub(r)),f.copy(v.clone().sub(s)),g.copy(t.clone()),j.copy(t.clone().add(r)),S.copy(n.clone()),k.copy(n.clone().sub(r)),P.copy(v.clone().sub(o.clone().multiplyScalar(a.lMax[i]*(a.Model.maxMaxContraction-a.maxContraction[i])))),V.copy(P.clone().add(c));try{z()}catch(l){console.log("error: changeColor")}}));var T=function(e){a.eStatus[i]=2,e.stopPropagation()},N=function(e){for(2!==a.eStatus[i]&&(a.eStatus[i]=1),e.stopPropagation(),o.showInfo&&(o.infoPanel.style.display="block"),o.infoPanel.style.left=String(e.clientX)+"px",o.infoPanel.style.top=String(e.clientY)+"px";o.infoPanel.firstChild;)o.infoPanel.removeChild(o.infoPanel.firstChild);o.infoPanel.appendChild(o.infoPanel.ownerDocument.createTextNode("L: "+String(Math.round(1e3*a.l[i])/1e3/1.2*93)+"mm")),o.infoPanel.appendChild(o.infoPanel.ownerDocument.createElement("br")),o.infoPanel.appendChild(o.infoPanel.ownerDocument.createTextNode("S: "+String(Math.round(1e3*a.l[i])/1e3/1.2*62)+"mm"))},H=function(e){2!==a.eStatus[i]&&(a.eStatus[i]=0),e.stopPropagation(),o.infoPanel.style.display="none"},E=A,F=[Object(m.jsx)(U,{v0:h,v1:u,d:.065,c:J,opacity:1,transparent:E,handleClick:T,handlePointerOver:N,handlePointerOut:H},"out"),Object(m.jsx)(U,{v0:v,v1:f,d:.05,c:I,opacity:1,transparent:E,handleClick:T,handlePointerOver:N,handlePointerOut:H},"in"),Object(m.jsx)(U,{v0:g,v1:j,d:M,c:D,opacity:1,transparent:E,handleClick:T,handlePointerOver:N,handlePointerOut:H},"joint0"),Object(m.jsx)(U,{v0:k,v1:S,d:M,c:D,opacity:1,transparent:E,handleClick:T,handlePointerOver:N,handlePointerOut:H},"joint1")];return a.maxContraction[i]!==a.Model.maxMaxContraction&&F.push(Object(m.jsx)(U,{v0:P,v1:V,d:.06,c:x},"constraint")),a.edgeActive[i]?F:[Object(m.jsx)(U,{v0:t,v1:n,d:M,c:L,opacity:1,transparent:!1,handleClick:T,handlePointerOver:N,handlePointerOut:H},"beam")]}function J(e){var t=e.model,n=e.sharedData,i=e.setOControls,o=a.a.useState(new d.Clock),s=Object(r.a)(o,1)[0];Object(p.c)((function(e){var i=1e3/30-s.getDelta();setTimeout((function(){e.ready=!0,e.invalidate()}),Math.max(0,i)),e.ready=!1;t.Model.h;t.step(Math.floor(1.5/t.Model.h/30)),t.iAction!==t.iActionPrev&&(n.updateGUI(),t.iActionPrev=t.iAction)}),0);var c,h=[],u=[],v=Object(l.a)(t.v.entries());try{for(v.s();!(c=v.n()).done;){var f=Object(r.a)(c.value,2),g=f[0],j=f[1];h.push(Object(m.jsx)(P,{v:j,iv:g,model:t,setOControls:i,sharedData:n},"J"+String(g)))}}catch(M){v.e(M)}finally{v.f()}var y,b=Object(l.a)(t.e.entries());try{for(b.s();!(y=b.n()).done;){var x=Object(r.a)(y.value,2),O=x[0],C=x[1],S=t.v[C[0]],w=t.v[C[1]];u.push(Object(m.jsx)(V,{v0:S,v1:w,ie:O,model:t,sharedData:n,selected:C.selected,hovered:C.hovered},"B"+String(O)))}}catch(M){b.e(M)}finally{b.f()}return[].concat(h,u)}function I(){var e=new d.DirectionalLight(new d.Color(1,1,1),1.5);e.position.set(0,0,5),e.castShadow=!0;return e.shadow.mapSize.width=600,e.shadow.mapSize.height=600,e.shadow.camera.top=-90,e.shadow.camera.right=90,e.shadow.camera.left=-90,e.shadow.camera.bottom=90,e.shadow.camera.near=.1,e.shadow.camera.far=500,Object(m.jsx)("primitive",{object:e})}window.fps=30;var D=function(e){var t=e.oControls,n=Object(p.d)(),i=n.camera,a=n.gl.domElement;return Object(p.c)((function(){return t.current.update()})),Object(m.jsx)("orbitControls",{ref:t,args:[i,a]})};var L=function(e){var t=e.model,n=e.sharedData,a=Object(i.useRef)();t.controls=a;var o=Object(i.useReducer)((function(e){return e+1}),0),s=Object(r.a)(o,2)[1];return t.forceUpdate=s,window.updateModel=s,t.recordHistory(),Object(m.jsxs)(p.a,{shadowMap:!0,concurrent:!0,onCreated:function(e){var t=e.gl;e.camera;t.setClearColor(new d.Color(1,1,1)),t.setPixelRatio(window.devicePixelRatio),t.shadowMap.enabled=!0,t.shadowMap.type=d.PCFSoftShadowMap},camera:{fov:45,position:[0,-20,1],up:[0,0,1]},gl:{antialias:!0},children:[Object(m.jsx)(D,{oControls:a}),Object(m.jsx)("ambientLight",{color:new d.Color(1,1,1),intensity:.5}),Object(m.jsx)(I,{}),Object(m.jsxs)("mesh",{position:[0,0,0],receiveShadow:!0,visible:!0,children:[Object(m.jsx)("planeGeometry",{args:[1e4,1e4]}),Object(m.jsx)("shadowMaterial",{opacity:.3})]}),Object(m.jsx)("gridHelper",{args:[100,100],"rotation-x":-Math.PI/2,"position-z":0,visible:!0}),Object(m.jsx)(J,{model:t,sharedData:n,setOControls:function(e){a.current.enabled=e}})]})},G=n(16),z=n(102),T=n(104),N=n(105),H=n(132),E=n(108),F=n(129),R=n(111),B=n(112),K=n(115),q=n(50),X=n(130),Z=n(106),Y=n(107),_=n(109),Q=n(110),W=n(113),$=n(114),ee=n(116),te=n(117),ne=n(118),ie=n(119),ae=n(120),oe=n(121),se=n(122),re=n(123),ce=n(124),le=n(125),he=n(126),de=n(127),ue=n(128),ve="rgba(200, 200, 200, 0.6)",fe=["rgb(100, 150, 220)","rgb(240, 240, 20)","rgb(200, 100, 200)","rgb(100, 200, 130)","rgb(200, 100, 100)"],pe=.5,ge=.1,je=Object(z.a)((function(e){return{mainGUI:{position:"absolute",right:"1.5vh",top:"1.5vh",width:"28vh",height:"auto",background:ve,"& .MuiList-root":{"& .MuiListItem-root":{minHeight:"6vh"}}},editingGUI:{position:"absolute",right:"30vh",top:"1.5vh",width:"30vh",background:ve},scriptGUI:{position:"absolute",left:"2vh",bottom:"2vh",background:ve},editingScriptGUI:{position:"absolute",right:"30vh",top:"44vh",width:"30vh",background:ve}}}));function me(e){var t=e.model,n=e.updateGUI,i=[];Object(G.a)(Array(t.e.length).keys()).every((function(e){return 2!==t.eStatus[e]||2===t.eStatus[e]&&!0===t.edgeActive[e]})),Object(G.a)(Array(t.e.length).keys()).every((function(e){return 2!==t.eStatus[e]||2===t.eStatus[e]&&!1===t.edgeActive[e]}));return i.push(Object(m.jsx)(T.a,{item:!0,style:{width:"50%",textAlign:"center"},children:Object(m.jsx)(N.a,{size:"small",onClick:function(){for(var e=0;e<t.e.length;e++)2===t.eStatus[e]&&(t.edgeActive[e]=!0,t.lMax[e]=t.Model.defaultMaxLength);n(),setTimeout(t.forceUpdate,50)},children:Object(m.jsx)(Z.a,{})})},"active")),i.push(Object(m.jsx)(T.a,{item:!0,style:{width:"50%",textAlign:"center"},children:Object(m.jsx)(N.a,{size:"small",onClick:function(){for(var e=0;e<t.e.length;e++)2===t.eStatus[e]&&(t.edgeActive[e]=!1);n(),setTimeout(t.forceUpdate,50)},children:Object(m.jsx)(Y.a,{})})},"passive")),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(E.a,{style:{width:"50%"},children:"Active / Passive"}),Object(m.jsx)(T.a,{container:!0,style:{width:"50%"},children:i})]})}function ye(e){for(var t=e.n,n=e.model,i=e.updateGUI,a=[],o=function(e){var o=!Object(G.a)(Array(n.e.length).keys()).every((function(t){return 2!==n.eStatus[t]||2===n.eStatus[t]&&n.edgeChannel[t]!==e})),s=fe[e];a.push(Object(m.jsx)(T.a,{item:!0,style:{width:"".concat(1/t*100,"%"),textAlign:"center"},children:Object(m.jsx)(N.a,{size:"small",onClick:function(){for(var t=0;t<n.e.length;t++)2===n.eStatus[t]&&(n.edgeChannel[t]=e);i()},children:o?Object(m.jsx)(_.a,{style:{color:s}}):Object(m.jsx)(Q.a,{style:{color:s}})})},e))},s=0;s<t;s++)o(s);return Object(m.jsx)(H.a,{children:Object(m.jsx)(T.a,{container:!0,styles:{width:"50%"},children:a})})}function be(e){var t=e.model,n=(e.sharedData,e.updateGUI,e.classes);t.precompute();for(var a=6*t.numActions+1,o=function(e){var t=e.model,a=e.iChannel,o=e.iAction,s=Object(i.useState)(!1),c=Object(r.a)(s,2),l=c[0],h=c[1],d=t.script[a][o],u=Object(i.useState)(o===t.iAction),v=Object(r.a)(u,2);v[0],v[1];return Object(m.jsx)(T.a,{item:!0,className:n.scriptBlock,style:{background:fe[a],width:"".concat(5,"vh"),height:"".concat(5,"vh"),padding:"".concat(1,"vh"),margin:"".concat(.5,"vh"),border:"".concat(l?"4px":"2px"," solid ").concat(t.iAction===o?"rgba(250, 100, 50, 0.9)":"rgba(250, 250, 250, 0.9)"),opacity:"".concat(d?1:l?.8:.1)},onPointerOver:function(){h(!0)},onPointerOut:function(){h(!1)},onClick:function(){t.script[a][o]=!d}},o)},s=function(e){for(var t=e.model,n=e.iChannel,i=[],a=0;a<t.numActions;a++){i.push(Object(m.jsx)(o,{model:t,isOn:!0,iChannel:n,iAction:a},a))}return Object(m.jsx)(T.a,{container:!0,item:!0,spacing:0,children:i})},c=[],l=0;l<t.numChannels;l++)c.push(Object(m.jsx)(s,{iChannel:l,model:t},l));return[Object(m.jsx)(T.a,{container:!0,item:!0,spacing:0,style:{padding:"".concat(pe,"vh"),width:"".concat(a,"vh")},children:c},"buttons")]}var xe=function(e){var t=e.model,n=(e.options,e.sharedData),a=Object(i.useReducer)((function(e){return e+1}),0),o=Object(r.a)(a,2)[1];n.updateGUI=o,window.updateGUI=o,t.recordHistory();var s=je();return[Object(m.jsx)("div",{className:s.mainGUI,onPointerOver:function(e){n.GUIHovered=!0},onPointerOut:function(e){n.GUIHovered=!1},children:Object(m.jsxs)(R.a,{children:[Object(m.jsxs)(H.a,{button:!0,onClick:function(e){t.recordV();var n=t.saveData(),i=JSON.stringify(n),a=document.createElement("a");document.body.appendChild(a),a.download="download.json",a.style.display="none",a.href="data:text/plain;charset=utf-8,"+encodeURIComponent(i),a.click(),document.body.removeChild(a)},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(W.a,{})}),Object(m.jsx)(E.a,{children:"Download"})]}),Object(m.jsxs)(H.a,{button:!0,selected:!1,onClick:function(e){var n=document.createElement("input");document.body.appendChild(n),n.type="file",n.id="inputFile",n.style="display:none",document.getElementById("inputFile").click(),document.getElementById("inputFile").onchange=function(){var e=new FileReader;e.onload=function(e){var n=e.target.result;window.inputFileString=n;var i=JSON.parse(n);window.data=i,t.loadDict(i),t.simulate=!1,t.Model.gravity=!0,t.forceUpdate(),o()},e.readAsText(document.getElementById("inputFile").files[0]),document.body.removeChild(n)}},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)($.a,{})}),Object(m.jsx)(E.a,{children:"Load"})]}),Object(m.jsx)(K.a,{}),Object(m.jsx)(K.a,{}),Object(m.jsxs)(H.a,{button:!0,selected:t.editing,onClick:function(e){if(t.editing=!t.editing,t.editing){n.editingScript=!1,t.simulate=!1,t.Model.gravity=!1,n.movingJoint=!1,n.removingJoint=!1,n.addingJoint=!1,t.center();for(var i=0;i<t.v.length;i++)t.vel*=0}t.editing||(n.movingJoint=!1,n.removingJoint=!1,n.addingJoint=!1,t.Model.gravity=!0,t.simulate=!0),t.controls.current.target=t.centroid(),o(),t.forceUpdate()},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(ee.a,{})}),Object(m.jsx)(E.a,{children:"Edit Shape (E)"})]}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(te.a,{})}),Object(m.jsx)(E.a,{style:{left:"2px"},children:"ChannelColor"}),Object(m.jsx)(F.a,{i:1,checked:n.showChannel,onChange:function(e){n.showChannel=!n.showChannel,o()}})]}),Object(m.jsx)(ye,{n:t.numChannels,model:t,updateGUI:o}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(q.a,{style:{width:"50%"},children:"Contraction"}),Object(m.jsx)(X.a,{style:{width:"50%"},disabled:!t.eStatus.includes(2)||!Object(G.a)(Array(t.e.length).keys()).every((function(e){return 2===t.eStatus[e]&&t.edgeActive[e]||2!==t.eStatus[e]})),defaultValue:t.Model.maxMaxContraction,"aria-labelledby":"discrete-slider-custom",step:t.Model.contractionInterval,min:0,max:t.Model.maxMaxContraction,valueLabelDisplay:"auto",onChange:function(e,n){for(var i=0;i<t.e.length;i++)2===t.eStatus[i]&&(t.maxContraction[i]=n)},onPointerUp:function(){t.forceUpdate()}})]}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(E.a,{style:{width:"50%"},children:"Fix Joints (F/U)"}),Object(m.jsxs)(T.a,{container:!0,style:{width:"50%"},spacing:0,alignItems:"center",children:[Object(m.jsx)(T.a,{item:!0,style:{width:"50%",textAlign:"center"},children:Object(m.jsx)(N.a,{size:"small",onClick:function(e){for(var n=0;n<t.v.length;n++)2===t.vStatus[n]&&(t.fixedVs[n]=!0);o(),t.forceUpdate()},children:Object(m.jsx)(ne.a,{})})},"fix"),Object(m.jsx)(T.a,{item:!0,style:{width:"50%",textAlign:"center"},children:Object(m.jsx)(N.a,{size:"small",onClick:function(e){for(var n=0;n<t.v.length;n++)2===t.vStatus[n]&&(t.fixedVs[n]=!1);o(),t.forceUpdate()},children:Object(m.jsx)(ie.a,{})})},"unfix")]})]}),Object(m.jsx)(K.a,{}),Object(m.jsx)(me,{model:t,updateGUI:o}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(q.a,{style:{width:"50%"},children:"Length"}),Object(m.jsx)(X.a,{style:{width:"50%"},disabled:!t.eStatus.includes(2)||!Object(G.a)(Array(t.e.length).keys()).every((function(e){return 2===t.eStatus[e]&&!t.edgeActive[e]||2!==t.eStatus[e]})),defaultValue:t.Model.defaultMinLength,"aria-labelledby":"discrete-slider-custom",step:t.Model.contractionInterval*t.Model.defaultMaxLength,min:t.Model.defaultMinLength,max:t.Model.defaultMaxLength,valueLabelDisplay:"auto",onChange:function(e,n){for(var i=0;i<t.e.length;i++)2===t.eStatus[i]&&!1===t.edgeActive[i]&&(t.lMax[i]=n);t.forceUpdate()},onPointerUp:function(){t.forceUpdate()}})]}),Object(m.jsx)(K.a,{}),Object(m.jsx)(K.a,{}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(ae.a,{})}),Object(m.jsx)(E.a,{children:"Gravity"}),Object(m.jsx)(F.a,{i:0,checked:t.Model.gravity,onChange:function(e){t.Model.gravity=!t.Model.gravity,o()}})]}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(oe.a,{})}),Object(m.jsx)(E.a,{children:"Simulate"}),Object(m.jsx)(F.a,{i:0,checked:t.simulate,onChange:function(e){t.simulate=!t.simulate,o()}})]}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(q.a,{style:{width:"50%"},children:"# of Actions"}),Object(m.jsx)(X.a,{style:{width:"50%"},defaultValue:t.Model.defaultNumActions,"aria-labelledby":"discrete-slider-custom",step:1,min:1,max:20,valueLabelDisplay:"auto",onChange:function(e,n){t.numActions=n,t.precompute(),o()}},"numActions")]}),Object(m.jsx)(K.a,{}),Object(m.jsx)(K.a,{}),Object(m.jsxs)(H.a,{button:!0,onClick:function(e){t.controls.current.target=t.centroid(),t.forceUpdate()},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(se.a,{})}),Object(m.jsx)(E.a,{children:"Look At Center"})]})]})},"mainGUI"),Object(m.jsx)("div",{className:s.editingGUI,style:t.editing?{display:"block"}:{display:"none"},onPointerOver:function(e){n.GUIHovered=!0},onPointerOut:function(e){n.GUIHovered=!1},children:Object(m.jsxs)(R.a,{children:[Object(m.jsxs)(H.a,{button:!0,onClick:function(e){for(var n=[],i=0;i<t.v.length;i++)2===t.vStatus[i]&&n.push(i);1===n.length&&(t.addJoint(n[0]),t.precompute(),t.recordV(),t.forceUpdate(),t.resetSelection(),o())},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(re.a,{})}),Object(m.jsx)(E.a,{children:"Add Joint (A)"})]}),Object(m.jsxs)(H.a,{button:!0,onClick:function(e){for(var n=[],i=0;i<t.v.length;i++)2===t.vStatus[i]&&n.push(i);t.addEdges(n),t.precompute(),t.forceUpdate(),t.resetSelection(),o()},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(ce.a,{})}),Object(m.jsx)(E.a,{children:"Connect Joints (C)"})]}),Object(m.jsxs)(H.a,{button:!0,onClick:function(e){for(var n=[],i=0;i<t.v.length;i++)2===t.vStatus[i]&&n.push(i);t.addTet(n),t.precompute(),t.forceUpdate(),t.resetSelection(),o()},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(le.a,{})}),Object(m.jsx)(E.a,{children:"Add Tet (T)"})]}),Object(m.jsxs)(H.a,{button:!0,onClick:function(e){for(var n=[],i=0;i<t.v.length;i++)2===t.vStatus[i]&&n.push(i);1===n.length&&(t.removeJoint(n[0]),t.precompute(),t.recordV(),t.forceUpdate(),t.resetSelection(),o())},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(he.a,{})}),Object(m.jsx)(E.a,{children:"Remove Joint (D)"})]}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(de.a,{})}),Object(m.jsx)(E.a,{children:"Move Joint (M)"}),Object(m.jsx)(F.a,{checked:n.movingJoint,onChange:function(e,i){n.movingJoint=i,i&&(n.removingJoint=!1,n.addingJoint=!1),t.simulate=!1,t.resetSelection(),o()}},"add_joint")]}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(E.a,{children:"\xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 \xa0 Move Body"}),Object(m.jsx)(F.a,{disabled:!n.movingJoint,checked:n.movingBody,onChange:function(e,t){n.movingBody=t,o()}},"add_joint")]}),Object(m.jsx)(K.a,{}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(E.a,{children:"X:"}),Object(m.jsx)(X.a,{defaultValue:0,"arial-labelledby":"continuous-slider",step:.01,min:-Math.PI,max:Math.PI,valueLabelDisplay:"auto",onMouseDown:function(e){},onMouseUp:function(e){},onChange:function(e,n){t.rotateTo(n,t.euler.y,t.euler.z)}},"sliderX")]}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(E.a,{children:"Y:"}),Object(m.jsx)(X.a,{defaultValue:0,"arial-labelledby":"continuous-slider",step:.01,min:-Math.PI,max:Math.PI,valueLabelDisplay:"auto",onMouseDown:function(e){},onMouseUp:function(e){},onChange:function(e,n){t.rotateTo(t.euler.x,n,t.euler.z)}},"sliderY")]}),Object(m.jsxs)(H.a,{children:[Object(m.jsx)(E.a,{children:"Z:"}),Object(m.jsx)(X.a,{defaultValue:0,"arial-labelledby":"continuous-slider",step:.01,min:-Math.PI,max:Math.PI,valueLabelDisplay:"auto",onMouseDown:function(e){},onMouseUp:function(e){},onChange:function(e,n){t.rotateTo(t.euler.x,t.euler.y,n)}},"sliderZ")]}),Object(m.jsxs)(H.a,{button:!0,onClick:function(e){t.numSteps=0,t.simulate=!1,t.v=t.v0,t.center(),t.precompute(),t.forceUpdate(),o()},children:[Object(m.jsx)(B.a,{children:Object(m.jsx)(ue.a,{})}),Object(m.jsx)(E.a,{children:"Center Model"})]})]})},"editingGUI"),Object(m.jsx)("div",{className:s.scriptGUI,style:(n.editingScript,{display:"block"}),onPointerOver:function(e){n.GUIHovered=!0},onPointerOut:function(e){n.GUIHovered=!1},children:Object(m.jsx)(be,{model:t,sharedData:n,classes:s,updateGUI:o})},"scriptGUI"),Object(m.jsxs)("div",{className:s.editingScriptGUI,style:n.editingScript?{display:"block"}:{display:"none"},onPointerOver:function(e){n.GUIHovered=!0},onPointerOut:function(e){n.GUIHovered=!1},children:[Object(m.jsxs)(T.a,{container:!0,item:!0,spacing:2,alignItems:"center",style:{padding:"".concat(pe,"vh"),paddingTop:"0",paddingBottom:"0",width:"".concat(40.2,"vh")},children:[Object(m.jsx)(T.a,{item:!0,style:{margin:"".concat(ge,"vh"),width:"10vh",fontSize:"small"},children:"Channels"}),Object(m.jsx)(T.a,{item:!0,style:{margin:"".concat(ge,"vh"),width:"".concat(20,"vh")},children:Object(m.jsx)(X.a,{defaultValue:t.Model.defaultNumChannels,"aria-labelledby":"discrete-slider-custom",step:1,min:1,max:5,valueLabelDisplay:"auto",onChange:function(e,n){t.numChannels=n,t.precompute(),o()}},"numChannels")})]},"numChannels"),Object(m.jsxs)(T.a,{container:!0,item:!0,spacing:2,alignItems:"center",style:{padding:"".concat(pe,"vh"),paddingTop:"0",paddingBottom:"0",width:"".concat(40.2,"vh")},children:[Object(m.jsx)(T.a,{item:!0,style:{margin:"".concat(ge,"vh"),width:"10vh",fontSize:"small"},children:"Actions"}),Object(m.jsx)(T.a,{item:!0,style:{margin:"".concat(ge,"vh"),width:"".concat(20,"vh")},children:Object(m.jsx)(X.a,{defaultValue:t.Model.defaultNumActions,"aria-labelledby":"discrete-slider-custom",step:1,min:1,max:20,valueLabelDisplay:"auto",onChange:function(e,n){t.numActions=n,t.precompute(),o()}},"numActions")})]},"numActions")]},"editingScriptGUI")]},Oe=new f;window.model=Oe;var Ce={updateGUI:null,GUIHovered:!1,unSelect:!1,addingJoint:!1,movingJoint:!1,movingBody:!1,removingJoint:!1,showChannel:!1,editingScript:!1,numActions:20,numChannels:4,infoPanel:null,showInfo:!1};Oe.sharedData=Ce,window.sharedData=Ce,Ce.infoPanel=document.getElementById("infoPanel"),Ce.infoPanel||(Ce.infoPanel=document.createElement("div"),document.body.appendChild(Ce.infoPanel)),Ce.infoPanel.id="infoPanel",Ce.infoPanel.style.background="rgba(255, 255, 255, 0.9)",Ce.infoPanel.style.position="absolute",Ce.infoPanel.style.padding="10px",Ce.infoPanel.appendChild(Ce.infoPanel.ownerDocument.createTextNode(" ")),window.addEventListener("pointerdown",(function(e){Ce.unSelect=!0}),!1),window.addEventListener("pointermove",(function(e){Ce.unSelect=!1}),!1),window.addEventListener("pointerup",(function(e){Ce.unSelect&&(Ce.GUIHovered||Oe.vStatus.every((function(e){return 1!==e}))&&Oe.eStatus.every((function(e){return 1!==e}))&&Oe.fStatus.every((function(e){return 1!==e}))&&(Oe.vStatus.fill(0),Oe.eStatus.fill(0),Oe.fStatus.fill(0)),Ce.updateGUI&&setTimeout((function(){Ce.updateGUI()}),10))}),!1),window.addEventListener("keydown",(function(e){if("KeyA"===e.code&&(e.metaKey||e.ctrlKey)&&(Oe.eStatus.fill(2),Oe.vStatus.fill(2)),"KeyZ"!==e.code||!e.metaKey&&!e.ctrlKey||e.shiftKey||(Oe.undo(),setTimeout((function(){window.updateModel()}),10)),"KeyZ"===e.code&&(e.metaKey||e.ctrlKey)&&e.shiftKey&&(Oe.redo(),setTimeout((function(){window.updateModel()}),10)),"KeyA"===e.code&&Oe.editing){for(var t=[],n=0;n<Oe.v.length;n++)2===Oe.vStatus[n]&&t.push(n);if(1!==t.length)return;Oe.addJoint(t[0]),Oe.precompute(),Oe.recordV(),Oe.forceUpdate(),Oe.resetSelection()}if("KeyM"===e.code&&Oe.editing){var i=!Ce.movingJoint;Ce.movingJoint=i,i&&(Ce.removingJoint=!1,Ce.addingJoint=!1),Oe.simulate=!1,Oe.resetSelection(),window.updateGUI()}if("KeyD"===e.code&&Oe.editing){for(var a=[],o=0;o<Oe.v.length;o++)2===Oe.vStatus[o]&&a.push(o);if(1!==a.length)return;Oe.removeJoint(a[0]),Oe.precompute(),Oe.recordV(),Oe.forceUpdate(),Oe.resetSelection()}if("KeyC"===e.code&&Oe.editing){for(var s=[],r=0;r<Oe.v.length;r++)2===Oe.vStatus[r]&&s.push(r);Oe.addEdges(s),Oe.precompute(),Oe.resetSelection(),Oe.forceUpdate()}if("KeyT"===e.code&&Oe.editing){for(var c=[],l=0;l<Oe.v.length;l++)2===Oe.vStatus[l]&&c.push(l);Oe.addTet(c),Oe.precompute(),Oe.forceUpdate(),Oe.resetSelection()}if("KeyF"===e.code){for(var h=0;h<Oe.v.length;h++)2===Oe.vStatus[h]&&(Oe.fixedVs[h]=!0);Oe.forceUpdate()}if("KeyU"===e.code){for(var d=0;d<Oe.v.length;d++)2===Oe.vStatus[d]&&(Oe.fixedVs[d]=!1);Oe.forceUpdate()}if("KeyE"===e.code){if(Oe.editing=!Oe.editing,Oe.editing){Ce.editingScript=!1,Oe.simulate=!1,Oe.Model.gravity=!1,Ce.movingJoint=!1,Ce.removingJoint=!1,Ce.addingJoint=!1,Oe.center();for(var u=0;u<Oe.v.length;u++)Oe.vel*=0}Oe.editing||(Ce.movingJoint=!1,Ce.removingJoint=!1,Ce.addingJoint=!1,Oe.Model.gravity=!0,Oe.simulate=!0),Oe.controls.current.target=Oe.centroid(),window.updateGUI(),Oe.forceUpdate()}}),!1);var Se=function(){return[Object(m.jsx)(L,{model:Oe,sharedData:Ce},"viewer"),Object(m.jsx)(xe,{id:"hehe",model:Oe,sharedData:Ce},"gui")]},we=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,134)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),i(e),a(e),o(e),s(e)}))},Me=document.getElementById("root");s.a.render(Object(m.jsx)(a.a.StrictMode,{children:Object(m.jsx)(Se,{})}),Me),we()}},[[82,1,2]]]);
//# sourceMappingURL=main.ab79a52f.chunk.js.map